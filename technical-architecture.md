# è‹±è¯­é˜…è¯»åº”ç”¨ - æŠ€æœ¯æ¶æ„è®¾è®¡

## æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              å®¢æˆ·ç«¯å±‚ (Client Layer)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± ç§»åŠ¨ç«¯H5åº”ç”¨      ğŸ’» Webç®¡ç†åå°        ğŸ“Š æ•°æ®åˆ†æé¢æ¿                    â”‚
â”‚  Vue.js + Vant UI    Vue.js + Element UI   Vue.js + ECharts                 â”‚
â”‚  PWAæ”¯æŒ             åå°ç®¡ç†åŠŸèƒ½           å®æ—¶æ•°æ®å¯è§†åŒ–                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                               HTTPS + CDN
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç½‘å…³å±‚ (Gateway Layer)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸšª APIç½‘å…³ (Nginx + Kong)                                                  â”‚
â”‚  - è·¯ç”±è½¬å‘           - é™æµç†”æ–­        - å®‰å…¨è®¤è¯                             â”‚
â”‚  - è´Ÿè½½å‡è¡¡           - æ—¥å¿—ç›‘æ§        - CORSå¤„ç†                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              åº”ç”¨å±‚ (Application Layer)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ”§ å¾®æœåŠ¡æ¶æ„ (Node.js + Express)                                          â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   ç”¨æˆ·æœåŠ¡       â”‚  â”‚   å†…å®¹æœåŠ¡       â”‚  â”‚   å­¦ä¹ æœåŠ¡       â”‚             â”‚
â”‚  â”‚ User Service    â”‚  â”‚Content Service  â”‚  â”‚Learning Service â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚â€¢ ç”¨æˆ·è®¤è¯æˆæƒ    â”‚  â”‚â€¢ æ–‡ç« ç®¡ç†       â”‚  â”‚â€¢ é˜…è¯»è¿›åº¦è·Ÿè¸ª    â”‚             â”‚
â”‚  â”‚â€¢ ä¸ªäººä¿¡æ¯ç®¡ç†    â”‚  â”‚â€¢ å†…å®¹çˆ¬å–       â”‚  â”‚â€¢ å•è¯åº“ç®¡ç†      â”‚             â”‚
â”‚  â”‚â€¢ ä¼šè¯ç®¡ç†       â”‚  â”‚â€¢ åˆ†ç±»æ ‡ç­¾       â”‚  â”‚â€¢ å­¦ä¹ ç»Ÿè®¡åˆ†æ    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â€¢ æœç´¢æ¨è       â”‚  â”‚â€¢ æ™ºèƒ½å¤ä¹ æé†’    â”‚             â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   å­—å…¸æœåŠ¡       â”‚  â”‚   é€šçŸ¥æœåŠ¡       â”‚  â”‚   æ–‡ä»¶æœåŠ¡       â”‚             â”‚
â”‚  â”‚Dictionary Svc   â”‚  â”‚Notification Svc â”‚  â”‚  File Service   â”‚             â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”‚
â”‚  â”‚â€¢ å¤šæºå­—å…¸é›†æˆ    â”‚  â”‚â€¢ æ¶ˆæ¯æ¨é€       â”‚  â”‚â€¢ å›¾ç‰‡ä¸Šä¼        â”‚             â”‚
â”‚  â”‚â€¢ æ™ºèƒ½ç¼“å­˜       â”‚  â”‚â€¢ é‚®ä»¶é€šçŸ¥       â”‚  â”‚â€¢ æ–‡ä»¶å­˜å‚¨       â”‚             â”‚
â”‚  â”‚â€¢ è¯ä¹‰åˆå¹¶       â”‚  â”‚â€¢ å­¦ä¹ æé†’       â”‚  â”‚â€¢ CDNåˆ†å‘        â”‚             â”‚
â”‚  â”‚â€¢ é™çº§å®¹é”™       â”‚  â”‚â€¢ å¤ä¹ æé†’       â”‚  â”‚â€¢ éŸ³é¢‘æ’­æ”¾       â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚           â”‚                                                                 â”‚
â”‚           v                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚                    å¤–éƒ¨å­—å…¸APIé›†æˆ (External APIs)                       â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”‚ ğŸ“š Oxford API    ğŸ“– Cambridge API   ğŸ“— Merriam-Webster   ğŸ” æœ‰é“è¯å…¸     â”‚
â”‚  â”‚ ğŸ“˜ æœ—æ–‡è¯å…¸      ğŸ“™ æŸ¯æ—æ–¯è¯å…¸      ğŸ“• Free Dictionary   ğŸŒ WordsAPI     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              æ•°æ®å±‚ (Data Layer)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’¾ ä¸»æ•°æ®åº“                ğŸ“Š ç¼“å­˜å±‚               ğŸ—„ï¸ æ–‡ä»¶å­˜å‚¨                â”‚
â”‚  MySQL 8.0 é›†ç¾¤            Redis Cluster          é˜¿é‡Œäº‘OSS/AWS S3           â”‚
â”‚  - è¯»å†™åˆ†ç¦»                - å­—å…¸ç¼“å­˜              - é™æ€èµ„æº                  â”‚
â”‚  - åˆ†åº“åˆ†è¡¨                - çƒ­ç‚¹æ•°æ®              - éŸ³é¢‘æ–‡ä»¶                  â”‚
â”‚  - ä¸»ä»å¤åˆ¶                - ä¼šè¯ç¼“å­˜              - å¤‡ä»½å½’æ¡£                  â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“ˆ æ—¶åºæ•°æ®åº“              ğŸ” æœç´¢å¼•æ“             ğŸ“ æ¶ˆæ¯é˜Ÿåˆ—                â”‚
â”‚  InfluxDB                  Elasticsearch           Redis + Bull Queue         â”‚
â”‚  - ç”¨æˆ·è¡Œä¸ºåŸ‹ç‚¹            - å…¨æ–‡æœç´¢              - å¼‚æ­¥ä»»åŠ¡                  â”‚
â”‚  - å­—å…¸æŸ¥è¯¢ç»Ÿè®¡            - æ™ºèƒ½æ¨è              - é‚®ä»¶å‘é€                  â”‚
â”‚  - æ€§èƒ½ç›‘æ§æ•°æ®            - æ—¥å¿—åˆ†æ              - å­—å…¸é¢„åŠ è½½                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆé€‰å‹

### å‰ç«¯æŠ€æœ¯æ ˆ

#### ç§»åŠ¨ç«¯H5åº”ç”¨
```javascript
{
  "æ¡†æ¶": "Vue.js 3.x",
  "UIç»„ä»¶åº“": "Vant UI 4.x",
  "çŠ¶æ€ç®¡ç†": "Pinia",
  "è·¯ç”±": "Vue Router 4.x",
  "æ„å»ºå·¥å…·": "Vite",
  "ç±»å‹æ£€æŸ¥": "TypeScript",
  "PWA": "Workbox",
  "æµ‹è¯•": "Vitest + Vue Test Utils",
  "éŸ³é¢‘æ’­æ”¾": "Howler.js"
}
```

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- å“åº”å¼è®¾è®¡ï¼Œé€‚é…å„ç§ç§»åŠ¨è®¾å¤‡
- PWAæ”¯æŒï¼Œç¦»çº¿é˜…è¯»åŠŸèƒ½
- è™šæ‹Ÿæ»šåŠ¨ï¼Œä¼˜åŒ–é•¿æ–‡ç« é˜…è¯»æ€§èƒ½
- æ‰‹åŠ¿æ“ä½œæ”¯æŒï¼ˆç‚¹å‡»æŸ¥è¯ã€æ»‘åŠ¨ç¿»é¡µï¼‰
- éŸ³æ ‡éŸ³é¢‘æ’­æ”¾æ”¯æŒ

#### ç®¡ç†åå°
```javascript
{
  "æ¡†æ¶": "Vue.js 3.x",
  "UIç»„ä»¶åº“": "Element Plus",
  "å›¾è¡¨åº“": "ECharts",
  "å¯Œæ–‡æœ¬ç¼–è¾‘": "TinyMCE",
  "è¡¨æ ¼ç»„ä»¶": "vxe-table"
}
```

### åç«¯æŠ€æœ¯æ ˆ

#### ä¸»è¦æŠ€æœ¯
```javascript
{
  "è¿è¡Œæ—¶": "Node.js 18.x LTS",
  "æ¡†æ¶": "Express.js",
  "è¯­è¨€": "TypeScript",
  "ORM": "Prisma",
  "è®¤è¯": "JWT + Passport.js",
  "APIæ–‡æ¡£": "Swagger/OpenAPI",
  "æµ‹è¯•": "Jest + Supertest",
  "HTTPå®¢æˆ·ç«¯": "Axios",
  "é™æµ": "express-rate-limit"
}
```

#### å¾®æœåŠ¡æ¶æ„
```yaml
services:
  user-service:
    description: "ç”¨æˆ·ç®¡ç†æœåŠ¡"
    port: 3001
    functions:
      - ç”¨æˆ·æ³¨å†Œç™»å½•
      - ä¸ªäººä¿¡æ¯ç®¡ç†
      - æƒé™æ§åˆ¶
      
  content-service:
    description: "å†…å®¹ç®¡ç†æœåŠ¡"
    port: 3002
    functions:
      - æ–‡ç« çˆ¬å–å’Œè§£æ
      - å†…å®¹åˆ†ç±»ç®¡ç†
      - æœç´¢å’Œæ¨è
      
  learning-service:
    description: "å­¦ä¹ åŠŸèƒ½æœåŠ¡"
    port: 3003
    functions:
      - é˜…è¯»è¿›åº¦è·Ÿè¸ª
      - å•è¯åº“ç®¡ç†
      - å­¦ä¹ æ•°æ®åˆ†æ
      
  dictionary-service:
    description: "å­—å…¸æœåŠ¡"
    port: 3004
    functions:
      - å¤šæºå­—å…¸APIé›†æˆ
      - æ™ºèƒ½ç¼“å­˜ç®¡ç†
      - è¯ä¹‰æ•°æ®åˆå¹¶
      - æœåŠ¡é™çº§å®¹é”™
      
  notification-service:
    description: "é€šçŸ¥æœåŠ¡"
    port: 3005
    functions:
      - æ¶ˆæ¯æ¨é€
      - é‚®ä»¶é€šçŸ¥
      - å­¦ä¹ æé†’
```

### æ•°æ®åº“è®¾è®¡

#### ä¸»æ•°æ®åº“ - MySQL 8.0
```sql
-- åˆ†åº“åˆ†è¡¨ç­–ç•¥
CREATE DATABASE enreading_user;       -- ç”¨æˆ·ç›¸å…³æ•°æ®
CREATE DATABASE enreading_content;    -- å†…å®¹ç›¸å…³æ•°æ®  
CREATE DATABASE enreading_learn;      -- å­¦ä¹ ç›¸å…³æ•°æ®
CREATE DATABASE enreading_dictionary; -- å­—å…¸ç¼“å­˜æ•°æ®

-- åˆ†è¡¨ç­–ç•¥
-- reading_records æŒ‰å¹´ä»½åˆ†è¡¨
CREATE TABLE reading_records_2024 LIKE reading_records;
CREATE TABLE reading_records_2025 LIKE reading_records;

-- dictionary_cache æŒ‰å•è¯é¦–å­—æ¯åˆ†è¡¨
CREATE TABLE dictionary_cache_a LIKE dictionary_cache;
CREATE TABLE dictionary_cache_b LIKE dictionary_cache;
-- ... å…¶ä»–å­—æ¯
```

#### ç¼“å­˜å±‚ - Redis
```javascript
// ç¼“å­˜ç­–ç•¥è®¾è®¡
const cacheConfig = {
  // ç”¨æˆ·ä¼šè¯ (30åˆ†é’Ÿ)
  userSession: {
    key: 'session:${userId}',
    ttl: 1800
  },
  
  // å­—å…¸æŸ¥è¯¢ç»“æœ (24å°æ—¶)  
  dictionaryResult: {
    key: 'dict:${word}',
    ttl: 86400
  },
  
  // çƒ­é—¨å•è¯ (7å¤©)
  popularWords: {
    key: 'popular:${word}',
    ttl: 604800
  },
  
  // ç”¨æˆ·é˜…è¯»è¿›åº¦ (å®æ—¶)
  readingProgress: {
    key: 'progress:${userId}:${articleId}',
    ttl: -1
  },
  
  // å­—å…¸APIçŠ¶æ€ (5åˆ†é’Ÿ)
  dictionaryApiStatus: {
    key: 'api:status:${apiName}',
    ttl: 300
  }
};
```

## æ ¸å¿ƒåŠŸèƒ½å®ç°æ–¹æ¡ˆ

### 1. å­—å…¸æœåŠ¡æ¶æ„

#### å­—å…¸æœåŠ¡æ ¸å¿ƒç±»
```javascript
// å­—å…¸æœåŠ¡ä¸»æ§åˆ¶å™¨
class DictionaryController {
  constructor() {
    this.dictionaryService = new DictionaryService();
    this.cacheManager = new DictionaryCacheManager();
    this.fallbackService = new DictionaryFallbackService();
  }

  async getWordDefinition(req, res) {
    try {
      const { word } = req.params;
      const { format = 'mobile', useCache = true } = req.query;
      
      // å‚æ•°éªŒè¯
      if (!this.isValidWord(word)) {
        return res.status(400).json({
          success: false,
          error: 'Invalid word format'
        });
      }

      // è·å–é‡Šä¹‰
      const definition = await this.dictionaryService.getWordDefinition(word, {
        format,
        useCache: useCache === 'true'
      });

      res.json({
        success: true,
        data: definition,
        cached: definition._cached || false
      });
    } catch (error) {
      console.error('Dictionary lookup failed:', error);
      
      // é™çº§å¤„ç†
      const fallback = await this.fallbackService.getFallbackDefinition(req.params.word);
      
      res.status(200).json({
        success: true,
        data: fallback,
        fallback: true,
        error: error.message
      });
    }
  }

  async batchGetDefinitions(req, res) {
    try {
      const { words } = req.body;
      
      if (!Array.isArray(words) || words.length > 20) {
        return res.status(400).json({
          success: false,
          error: 'Invalid words array (max 20 words)'
        });
      }

      const results = await Promise.allSettled(
        words.map(word => this.dictionaryService.getWordDefinition(word))
      );

      const definitions = results.map((result, index) => ({
        word: words[index],
        success: result.status === 'fulfilled',
        data: result.status === 'fulfilled' ? result.value : null,
        error: result.status === 'rejected' ? result.reason.message : null
      }));

      res.json({
        success: true,
        data: definitions
      });
    } catch (error) {
      res.status(500).json({
        success: false,
        error: error.message
      });
    }
  }
}
```

#### å¤šæºå­—å…¸é›†æˆ
```javascript
class DictionaryService {
  constructor() {
    this.dictionaries = new Map([
      ['oxford', new OxfordDictionary()],
      ['cambridge', new CambridgeDictionary()],
      ['merriam-webster', new MerriamWebsterDictionary()],
      ['youdao', new YoudaoDictionary()],
      ['freedict', new FreeDictionary()]
    ]);
    
    this.cache = new DictionaryCache();
    this.healthMonitor = new DictionaryHealthMonitor();
    this.rateLimiter = new DictionaryRateLimiter();
  }

  async getWordDefinition(word, options = {}) {
    const normalizedWord = this.normalizeWord(word);
    
    // 1. æ£€æŸ¥ç¼“å­˜
    if (options.useCache) {
      const cached = await this.cache.get(normalizedWord);
      if (cached) {
        return { ...cached, _cached: true };
      }
    }

    // 2. è·å–å¯ç”¨çš„å­—å…¸æº
    const availableDictionaries = await this.getAvailableDictionaries();
    
    // 3. å¹¶è¡ŒæŸ¥è¯¢å¤šä¸ªå­—å…¸æº
    const results = await this.queryDictionaries(normalizedWord, availableDictionaries);
    
    // 4. åˆå¹¶ç»“æœ
    const merged = this.mergeResults(results);
    
    // 5. ç¼“å­˜ç»“æœ
    await this.cache.set(normalizedWord, merged);
    
    return merged;
  }

  async getAvailableDictionaries() {
    const available = [];
    
    for (const [name, dictionary] of this.dictionaries) {
      const isHealthy = await this.healthMonitor.isHealthy(name);
      const hasQuota = await this.rateLimiter.hasQuota(name);
      
      if (isHealthy && hasQuota) {
        available.push({
          name,
          dictionary,
          priority: dictionary.priority
        });
      }
    }
    
    return available.sort((a, b) => a.priority - b.priority);
  }

  async queryDictionaries(word, dictionaries) {
    const promises = dictionaries.map(async ({ name, dictionary }) => {
      try {
        // åº”ç”¨é€Ÿç‡é™åˆ¶
        await this.rateLimiter.acquire(name);
        
        const startTime = Date.now();
        const result = await dictionary.lookup(word);
        const responseTime = Date.now() - startTime;
        
        // è®°å½•æˆåŠŸæŒ‡æ ‡
        await this.healthMonitor.recordSuccess(name, responseTime);
        
        return {
          source: name,
          priority: dictionary.priority,
          data: result,
          success: true,
          responseTime
        };
      } catch (error) {
        // è®°å½•å¤±è´¥æŒ‡æ ‡
        await this.healthMonitor.recordFailure(name, error);
        
        return {
          source: name,
          priority: dictionary.priority,
          error: error.message,
          success: false
        };
      }
    });

    const results = await Promise.allSettled(promises);
    
    return results
      .filter(result => result.status === 'fulfilled' && result.value.success)
      .map(result => result.value);
  }

  mergeResults(results) {
    if (results.length === 0) {
      throw new Error('No dictionary sources available');
    }

    const primary = results[0];
    
    return {
      word: primary.data.word,
      phonetic: this.mergePronunciations(results),
      definitions: this.mergeDefinitions(results),
      examples: this.mergeExamples(results),
      audio: this.mergeAudioUrls(results),
      etymology: primary.data.etymology || null,
      frequency: this.calculateFrequency(primary.data),
      difficulty: this.assessDifficulty(primary.data),
      sources: results.map(r => r.source),
      quality: this.calculateQuality(results),
      timestamp: new Date().toISOString()
    };
  }
}
```

### 2. æ™ºèƒ½ç¼“å­˜ç®¡ç†

#### ç¼“å­˜ç®¡ç†å™¨
```javascript
class DictionaryCacheManager {
  constructor() {
    this.redis = new Redis(process.env.REDIS_URL);
    this.db = new PrismaClient();
    this.localCache = new Map(); // å†…å­˜ç¼“å­˜
  }

  async get(word) {
    // 1. å†…å­˜ç¼“å­˜ (æœ€å¿«)
    if (this.localCache.has(word)) {
      const cached = this.localCache.get(word);
      if (Date.now() - cached.timestamp < 300000) { // 5åˆ†é’Ÿ
        return cached.data;
      }
      this.localCache.delete(word);
    }

    // 2. Redisç¼“å­˜ (å¿«)
    const redisKey = `dict:${word}`;
    const redisCached = await this.redis.get(redisKey);
    if (redisCached) {
      const data = JSON.parse(redisCached);
      
      // æ›´æ–°å†…å­˜ç¼“å­˜
      this.localCache.set(word, {
        data,
        timestamp: Date.now()
      });
      
      return data;
    }

    // 3. æ•°æ®åº“ç¼“å­˜ (æ…¢ä½†æŒä¹…)
    const dbCached = await this.db.dictionaryCache.findUnique({
      where: { word: word.toLowerCase() }
    });
    
    if (dbCached) {
      // æ›´æ–°Rediså’Œå†…å­˜ç¼“å­˜
      await this.redis.setex(redisKey, 86400, JSON.stringify(dbCached.data));
      this.localCache.set(word, {
        data: dbCached.data,
        timestamp: Date.now()
      });
      
      return dbCached.data;
    }

    return null;
  }

  async set(word, data) {
    const redisKey = `dict:${word}`;
    
    // 1. æ›´æ–°å†…å­˜ç¼“å­˜
    this.localCache.set(word, {
      data,
      timestamp: Date.now()
    });
    
    // 2. æ›´æ–°Redisç¼“å­˜
    await this.redis.setex(redisKey, 86400, JSON.stringify(data));
    
    // 3. æ›´æ–°æ•°æ®åº“ç¼“å­˜
    await this.db.dictionaryCache.upsert({
      where: { word: word.toLowerCase() },
      update: {
        data,
        sources: data.sources,
        quality_score: data.quality,
        last_updated: new Date(),
        access_count: { increment: 1 }
      },
      create: {
        word: word.toLowerCase(),
        data,
        sources: data.sources,
        quality_score: data.quality,
        access_count: 1
      }
    });
  }

  // æ¸…ç†è¿‡æœŸç¼“å­˜
  async cleanup() {
    // æ¸…ç†å†…å­˜ç¼“å­˜
    const now = Date.now();
    for (const [word, cached] of this.localCache) {
      if (now - cached.timestamp > 300000) { // 5åˆ†é’Ÿè¿‡æœŸ
        this.localCache.delete(word);
      }
    }

    // æ¸…ç†ä½è´¨é‡çš„æ•°æ®åº“ç¼“å­˜
    await this.db.dictionaryCache.deleteMany({
      where: {
        AND: [
          { quality_score: { lt: 0.5 } },
          { access_count: { lt: 5 } },
          { last_updated: { lt: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000) } }
        ]
      }
    });
  }
}
```

### 3. å‰ç«¯å•è¯æŸ¥è¯¢ä¼˜åŒ–

#### å‰ç«¯å•è¯ç‚¹å‡»å¤„ç†
```javascript
class WordClickHandler {
  constructor(container) {
    this.container = container;
    this.dictionaryAPI = new DictionaryAPI();
    this.audioPlayer = new AudioPlayer();
    this.setupWordClickListener();
    this.preloadQueue = new Set();
  }

  setupWordClickListener() {
    this.container.addEventListener('click', async (event) => {
      const target = event.target;
      
      // æ£€æŸ¥æ˜¯å¦ç‚¹å‡»äº†å•è¯
      if (this.isClickableWord(target)) {
        event.preventDefault();
        
        const word = this.extractWord(target);
        const rect = target.getBoundingClientRect();
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        this.showLoadingPopup(word, rect);
        
        try {
          // è·å–é‡Šä¹‰
          const definition = await this.dictionaryAPI.getDefinition(word);
          
          // æ˜¾ç¤ºé‡Šä¹‰å¼¹çª—
          this.showDefinitionPopup(word, definition, rect);
          
          // é¢„åŠ è½½ç›¸å…³å•è¯
          this.preloadRelatedWords(definition);
          
        } catch (error) {
          this.showErrorPopup(word, error.message, rect);
        }
      }
    });
  }

  async getDefinition(word) {
    // å…ˆæ£€æŸ¥æœ¬åœ°ç¼“å­˜
    const cached = this.getFromLocalCache(word);
    if (cached) {
      return cached;
    }

    // ä»APIè·å–
    const response = await fetch(`/api/dictionary/define/${encodeURIComponent(word)}`, {
      headers: {
        'Authorization': `Bearer ${this.getAuthToken()}`,
        'Content-Type': 'application/json'
      }
    });

    if (!response.ok) {
      throw new Error(`Dictionary lookup failed: ${response.statusText}`);
    }

    const result = await response.json();
    
    if (!result.success) {
      throw new Error(result.error || 'Unknown error occurred');
    }

    // ç¼“å­˜ç»“æœ
    this.setLocalCache(word, result.data);
    
    return result.data;
  }

  showDefinitionPopup(word, definition, rect) {
    // ç§»é™¤ç°æœ‰å¼¹çª—
    this.removeExistingPopups();
    
    const popup = document.createElement('div');
    popup.className = 'word-definition-popup';
    popup.innerHTML = this.renderDefinitionHTML(word, definition);
    
    // è®¡ç®—å¼¹çª—ä½ç½®
    const position = this.calculatePopupPosition(rect);
    popup.style.left = `${position.x}px`;
    popup.style.top = `${position.y}px`;
    
    document.body.appendChild(popup);
    
    // ç»‘å®šäº‹ä»¶
    this.bindPopupEvents(popup, word, definition);
    
    // æ·»åŠ åŠ¨ç”»
    requestAnimationFrame(() => {
      popup.classList.add('show');
    });
  }

  renderDefinitionHTML(word, definition) {
    return `
      <div class="word-popup-header">
        <h3 class="word-title">${word}</h3>
        ${definition.phonetic ? `
          <div class="pronunciation">
            <span class="phonetic">${definition.phonetic}</span>
            ${definition.audio ? `
              <button class="audio-btn" data-audio="${definition.audio}">ğŸ”Š</button>
            ` : ''}
          </div>
        ` : ''}
        <button class="close-btn">âœ•</button>
      </div>
      
      <div class="definitions">
        ${definition.definitions.map((def, index) => `
          <div class="definition-item">
            <span class="part-of-speech">${def.partOfSpeech}</span>
            <p class="meaning">${def.meaning}</p>
          </div>
        `).join('')}
      </div>
      
      ${definition.examples && definition.examples.length > 0 ? `
        <div class="examples">
          <h4>ä¾‹å¥:</h4>
          ${definition.examples.slice(0, 2).map(example => `
            <p class="example">"${example}"</p>
          `).join('')}
        </div>
      ` : ''}
      
      <div class="actions">
        <button class="add-to-vocabulary-btn" data-word="${word}">
          ğŸ“š åŠ å…¥å•è¯åº“
        </button>
        <button class="share-btn" data-word="${word}">
          ğŸ“¤ åˆ†äº«
        </button>
      </div>
    `;
  }

  bindPopupEvents(popup, word, definition) {
    // å…³é—­æŒ‰é’®
    popup.querySelector('.close-btn').addEventListener('click', () => {
      this.removePopup(popup);
    });

    // éŸ³é¢‘æ’­æ”¾
    const audioBtn = popup.querySelector('.audio-btn');
    if (audioBtn) {
      audioBtn.addEventListener('click', () => {
        const audioUrl = audioBtn.dataset.audio;
        this.audioPlayer.play(audioUrl);
      });
    }

    // æ·»åŠ åˆ°å•è¯åº“
    popup.querySelector('.add-to-vocabulary-btn').addEventListener('click', async () => {
      try {
        await this.addToVocabulary(word, definition);
        this.showSuccessToast('å·²æ·»åŠ åˆ°å•è¯åº“');
      } catch (error) {
        this.showErrorToast('æ·»åŠ å¤±è´¥: ' + error.message);
      }
    });

    // ç‚¹å‡»å¤–éƒ¨å…³é—­
    document.addEventListener('click', (event) => {
      if (!popup.contains(event.target)) {
        this.removePopup(popup);
      }
    }, { once: true });
  }
}
```

è¿™ä¸ªè°ƒæ•´åçš„æŠ€æœ¯æ¶æ„å……åˆ†ä½“ç°äº†å¤–éƒ¨å­—å…¸APIçš„é›†æˆç­–ç•¥ï¼Œé€šè¿‡æ™ºèƒ½ç¼“å­˜ã€å¥åº·ç›‘æ§ã€é™çº§å®¹é”™ç­‰æœºåˆ¶ï¼Œç¡®ä¿å­—å…¸æœåŠ¡çš„é«˜å¯ç”¨æ€§å’Œä¼˜ç§€ç”¨æˆ·ä½“éªŒã€‚ 